{
  "extends": ["next/core-web-vitals", "plugin:security/recommended-legacy"],
  "plugins": ["security"],
  "rules": {
    "security/detect-object-injection": "warn",
    "security/detect-non-literal-regexp": "warn",
    "security/detect-unsafe-regex": "error",
    "security/detect-buffer-noassert": "error",
    "security/detect-child-process": "error",
    "security/detect-disable-mustache-escape": "error",
    "security/detect-eval-with-expression": "error",
    "security/detect-no-csrf-before-method-override": "error",
    "security/detect-non-literal-fs-filename": "warn",
    "security/detect-non-literal-require": "warn",
    "security/detect-possible-timing-attacks": "warn",
    "security/detect-pseudoRandomBytes": "error",
    "security/detect-new-buffer": "error",
    "security/detect-bidi-characters": "error",
    "no-restricted-syntax": [
      "warn",
      {
        "selector": "NewExpression[callee.name='Date'][arguments.length=1][arguments.0.type='Literal'][arguments.0.value=/^\\d{4}-\\d{2}-\\d{2}$/]",
        "message": "Do not use new Date() with date-only strings (YYYY-MM-DD). This interprets as UTC midnight and displays wrong dates. Use formatBusinessDate() from @/utils/date-format.utils for business dates, or formatDateTime() with timezone for timestamps. See nuvana_docs/plans/time-fix.md"
      },
      {
        "selector": "NewExpression[callee.name='Date'][arguments.length=1][arguments.0.type='TemplateLiteral']",
        "message": "Caution: new Date() with template literals may cause timezone bugs. For YYYY-MM-DD business dates, use formatBusinessDate(). For timestamps, use formatDateTime() with store timezone. See nuvana_docs/plans/time-fix.md"
      }
    ]
  },
  "overrides": [
    {
      "files": ["tests/**/*.ts", "tests/**/*.tsx"],
      "rules": {
        "react-hooks/rules-of-hooks": "off",
        "security/detect-non-literal-fs-filename": "off",
        "security/detect-object-injection": "off"
      }
    },
    {
      "files": [
        "backend/src/services/pos/**/*.ts",
        "backend/src/services/naxml/**/*.ts"
      ],
      "rules": {
        "security/detect-non-literal-fs-filename": "off",
        "security/detect-object-injection": "off"
      }
    }
  ]
}
